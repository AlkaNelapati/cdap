# This is an example for rsyslog, to pick up Continuuity logs and send them to Haystack
# Log directories will need to be changed to their real locations
$ModLoad imfile

$Ruleset myJSON
# Template
$template myJSON,"{'host' : '%HOSTNAME%', 'component' : '%syslogtag%', 'logline' : '%msg%'}\n",option.json

# Output
*.* -/tmp/test.log;myJSON
& ^/usr/local/bin/log_uploader.sh;myJSON
& ~

# app-fabric gateway gateway-yarn kafka-server log-saver metrics-processor opex router web-app

# app-fabric
$InputFileName /var/log/continuuity/app-fabric-continuuity-%HOSTNAME%.log
$InputFileTag app-fabric
$InputFileStateFile app-fabric.state
$InputFileFacility local0
$InputFilePollInterval 1
$InputFileReadMode 2
$InputFileBindRuleset myJSON
$InputRunFileMonitor

# gateway
$InputFileName /var/log/continuuity/gateway-continuuity-%HOSTNAME%.log
$InputFileTag gateway
$InputFileStateFile gateway.state
$InputFileFacility local0
$InputFilePollInterval 1
$InputFileReadMode 2
$InputFileBindRuleset myJSON
$InputRunFileMonitor

# gateway-yarn
$InputFileName /var/log/continuuity/gateway-yarn-continuuity-%HOSTNAME%.log
$InputFileTag gateway-yarn
$InputFileStateFile gateway-yarn.state
$InputFileFacility local0
$InputFilePollInterval 1
$InputFileReadMode 2
$InputFileBindRuleset myJSON
$InputRunFileMonitor

# kafka-server
$InputFileName /var/log/continuuity/kafka-server-continuuity-%HOSTNAME%.log
$InputFileTag kafka-server
$InputFileStateFile kafka-server.state
$InputFileFacility local0
$InputFilePollInterval 1
$InputFileReadMode 2
$InputFileBindRuleset myJSON
$InputRunFileMonitor

# log-saver
$InputFileName /var/log/continuuity/log-saver-continuuity-%HOSTNAME%.log
$InputFileTag log-saver
$InputFileStateFile log-saver.state
$InputFileFacility local0
$InputFilePollInterval 1
$InputFileReadMode 2
$InputFileBindRuleset myJSON
$InputRunFileMonitor

# metrics-processor
$InputFileName /var/log/continuuity/metrics-processor-continuuity-%HOSTNAME%.log
$InputFileTag metrics-processor
$InputFileStateFile metrics-processor.state
$InputFileFacility local0
$InputFilePollInterval 1
$InputFileReadMode 2
$InputFileBindRuleset myJSON
$InputRunFileMonitor

# opex
$InputFileName /var/log/continuuity/opex-continuuity-%HOSTNAME%.log
$InputFileTag opex
$InputFileStateFile opex.state
$InputFileFacility local0
$InputFilePollInterval 1
$InputFileReadMode 2
$InputFileBindRuleset myJSON
$InputRunFileMonitor

# router
$InputFileName /var/log/continuuity/router-continuuity-%HOSTNAME%.log
$InputFileTag router
$InputFileStateFile router.state
$InputFileFacility local0
$InputFilePollInterval 1
$InputFileReadMode 2
$InputFileBindRuleset myJSON
$InputRunFileMonitor

# web-app
$InputFileName /var/log/continuuity/web-app-continuuity-%HOSTNAME%.log
$InputFileTag web-app
$InputFileStateFile web-app.state
$InputFileFacility local0
$InputFilePollInterval 1
$InputFileReadMode 2
$InputFileBindRuleset myJSON
$InputRunFileMonitor

